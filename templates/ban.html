<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Danh m·ª•c b√†n</title>

<style>
body{
    font-family: "Segoe UI", Arial;
    background:#ffd6e8;
    padding:30px;
}
.container{
    width:1000px;
    margin:auto;
    background:#ffc0cb;
    padding:25px;
    border-radius:14px;
    box-shadow:0 10px 25px rgba(0,0,0,.2);
}
h3{
    text-align:center;
    margin-bottom:20px;
}

/* TOOLBAR */
.toolbar{
    display:flex;
    gap:10px;
    margin-bottom:15px;
}
button{
    padding:8px 16px;
    border:none;
    border-radius:8px;
    font-weight:600;
    cursor:pointer;
}
.btn-them{background:#28a745;color:white}
.btn-sua{background:#ffc107}
.btn-xoa{background:#dc3545;color:white}
.btn-clear{background:#0dcaf0}

/* FORM */
.form{
    display:grid;
    grid-template-columns:120px 1fr;
    gap:10px;
    margin-bottom:20px;
}
input,select{
    padding:7px;
    border-radius:6px;
    border:1px solid #ccc;
}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
    background:white;
}
th{
    background:#0d2bf3;
    color:white;
    padding:10px;
}
td{
    padding:8px;
    border:1px solid #ccc;
    text-align:center;
}
tr:hover{
    background:#e6f0ff;
    cursor:pointer;
}

/* ALERT */
.alert{
    padding:10px 14px;
    border-radius:8px;
    margin-bottom:15px;
    font-weight:600;
}
.success{
    background:#d1e7dd;
    color:#0f5132;
    border:1px solid #badbcc;
}
</style>
</head>

<body>
<div class="container">

<h3>DANH M·ª§C B√ÄN</h3>

<!-- TH√îNG B√ÅO -->
{% if request.args.get("msg") == "them_ok" %}
<div class="alert success">‚úîÔ∏è Th√™m b√†n m·ªõi th√†nh c√¥ng</div>
{% endif %}

{% if request.args.get("msg") == "sua_ok" %}
<div class="alert success">
‚úîÔ∏è S·ª≠a b√†n {{ request.args.get("ban") }} th√†nh c√¥ng
</div>
{% endif %}

{% if request.args.get("msg") == "xoa_ok" %}
<div class="alert success">
‚úîÔ∏è X√≥a b√†n {{ request.args.get("ban") }} th√†nh c√¥ng
</div>
{% endif %}

<!-- FORM -->
<form id="formBan" method="post" action="/luu">
    <input type="hidden" name="action" id="action">

    <div class="toolbar">
        <button type="submit" class="btn-them" onclick="setAction('them')">‚ûï Th√™m</button>
        <button type="submit" class="btn-sua" onclick="return sua()">‚úèÔ∏è S·ª≠a</button>
        <button type="button" class="btn-xoa" onclick="xoa()">üóë X√≥a</button>
        <button type="button" class="btn-clear" onclick="xoaTrang()">‚ùå X√≥a tr·∫Øng</button>
    </div>

    <div class="form">
        <label>M√£ b√†n</label>
        <input id="so_ban" name="so_ban" required>

        <label>S·ª©c ch·ª©a</label>
        <input id="suc_chua" name="suc_chua" type="number" min="1" required>

        <label>Tr·∫°ng th√°i</label>
        <select id="trang_thai" name="trang_thai">
            <option value="1">B√†n tr·ªëng</option>
            <option value="0">B√†n c√≥ ng∆∞·ªùi</option>
        </select>
    </div>
</form>

<!-- TABLE -->
<table>
<tr>
    <th>M√£ b√†n</th>
    <th>S·ª©c ch·ª©a</th>
    <th>Tr·∫°ng th√°i</th>
</tr>

{% for b in ds_ban %}
<tr onclick="chonBan('{{ b.so_ban }}','{{ b.suc_chua }}','{{ b.trang_thai }}')">
    <td>{{ b.so_ban }}</td>
    <td>{{ b.suc_chua }}</td>
    <td>{{ "B√†n tr·ªëng" if b.trang_thai == 1 else "B√†n c√≥ ng∆∞·ªùi" }}</td>
</tr>
{% endfor %}
</table>

</div>

<script>
let banDangChon = "";

function chonBan(ma, suc, tt){
    document.getElementById("so_ban").value = ma;
    document.getElementById("suc_chua").value = suc;
    document.getElementById("trang_thai").value = tt;
    banDangChon = ma;
}

function setAction(act){
    document.getElementById("action").value = act;
}

function sua(){
    if(banDangChon === ""){
        alert("Vui l√≤ng ch·ªçn b√†n c·∫ßn s·ª≠a!");
        return false;
    }
    setAction("sua");
    return true;
}

function xoa(){
    if(banDangChon === ""){
        alert("Vui l√≤ng ch·ªçn b√†n c·∫ßn x√≥a!");
        return;
    }
    if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a b√†n " + banDangChon + " ?")){
        window.location.href = "/xoa/" + banDangChon;
    }
}

function xoaTrang(){
    document.getElementById("formBan").reset();
    banDangChon = "";
}
</script>

</body>
</html>
